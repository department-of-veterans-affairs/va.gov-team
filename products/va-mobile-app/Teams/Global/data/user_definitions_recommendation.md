# Recommendation: How to define mobile app users and downloads?

See ticket [#6084 Define analytics for "active user"](https://github.com/department-of-veterans-affairs/va-mobile-app/issues/6084) for background and links to related prior work.

## Executive summary

### Problems

1. The term ***Active User***, which is the base of our monthly monitoring, is misleading and limiting our ability to make strategic, data-informed decisions.
    * Currently, the team relies on Google Analytics definition of an ***Active User*** as our base for understanding all per-person tracking in the app.
    * This definition, however, includes anyone who opens the app regardless of whether they log in, spend more than a few seconds in the app, or perform/complete any tasks.
    * The name implies a level of utilization of the app that isn't actually part of the definition.

2. The definitions of downloads we are using from the two app stores are not comparable to one another.
    * For ***Android devices, specifically,*** no official documentation could be found for the data point we have been using as a count of downloads.We cannot be sure what it is counting. (Details of the discovery of this problem are in the [Appendix 1](#appendix-1)).

### Goals

* To **clearly define users from a Veteran perspective** with separate definitions for users at different points in the funnel from download to being able to engage with their personal data in the app
* To know the appropriate user definition to use as a denominator for different measures
* To **clearly define downloads** in a way that is comparable across iOS and Android downloads

### Recommended new definitions

Based on the problems described below and diagraming of our login flows to identify data gathering options/improvements, I am recommending we implement analytics to enable the following definitions to be tracked.

|Term|Veteran user experience|Dashboard/non-technical definition|LOE to gather data to report this|
| -------- | -------- | -------- | -------- |
|Downloads|I downloaded the app for the first time with this particular Apple ID/Google Play login.|Total first time downloads counted per account used to login app store| None; data already available |
|User|I have this app on my phone and opened it.|Anyone who opened the app| None; data already available |
|Authenticated user|***Not a part of direct user experience.***|User who is able to complete login process but not necessarily able to access their personal information|Low; analtyics must be adjusted|
|Personalized user|I was able to log into the app.|Authenticated user who is able to access their personal info in the app|Low; analtyics must be adjusted|

Additional information on how these definitons would shape metric calculations in the [Appendix 2](#appendix-2).

---

## Detailed definitions

### MVP custom user definitions

Each user definition can be counted as unique users or unique users sessions. They can also be divided into segments based on first session and return sessions. See [Appendix 3](#appendix-3) for definitions of session, first session, and return session.

#### User

* **Dashboard user definition**: Anyone who opened the app
* **Source**: Firebase app event data point user_pseudo_id
* **Technical definition**: This value is automatically generated by Firebase Analytics per user per device and logged for every event tracked.
* **Known caveats**: Potential for double counting anyone who uses the app on more than one device.

#### Authenticated user

* **Dashboard user definition**: User who is able to complete login process but not necessarily able to access their personal information
* **Source**: Firebase app custom event vama_login_token_success
* **Technical definition**: User for whom the app was able to fetch an access token:
  * For first-time and non-biometric logins, this will be when SIS successfully returns the token after the user completes authentication on VA.gov webview.
  * For subsequent biometric logins, this will be when the app receives the access token from secure app storage.
* **Known caveats**
  * Currently vama_login_success logs the first part of the technical definition but is not logging as described for biometric logins.
  * vama_login_token_success will replace/improve upon what vama_login_success was tracking to match the technical definition here.
  * vama_login_success will be moved to more accurately reflect the user experience of successfully logging in, and will be used in the ***personalized user*** definition.

#### Personalized user

* **Dashboard user definition**: Authenticated user who is able to access their personal info in the app; a successfully logged in experience from the user's perspective
* **Source**: Firebase app event data vama_login_success
* **Technical definition**: User for whom the app is able to return personal information from API endpoints after vama_login_token_success
* **Known caveats**: See above caveats for ***authenticated user***.

### Proposed downloads definition

#### Downloads

* **Dashboard user definition**: Total number of new downloads
* **Source**: App stores (covered individually in next sections)
* **Technical definition**: sum of iOS First-Time Downloads and Android New Users (covered individually in next sections)
* **Known caveats**:
  * We cannot track an individual from app store data to app user data at this time.
  * Android and iOS use different time zones for their days.
  * App stores count users per account used to download apps from their store. One person may be several users at one time or over time.

##### iOS Downloads

* **Dashboard user definition**: First-time downloads on iOS devices
* **Source**: Apple Store Connect Metrics
* **Technical definition**
  * First-Time Downloads: "[The total number of first time downloads of your app.](https://developer.apple.com/help/app-store-connect/reference/app-metrics/)"
  * Users are counted per unique Apple ID user account used to download.
  * Calculated per day based on Coordinated Universal Time (UTC)
* **Known caveats**
  * If a user re-downloads while logged into the App Store with the same Apple ID user account they previously downloaded from, they will not be double counted as a new user. It is possible that the same person may use more than one Apple ID to download over time.

##### Android Downloads

* **Dashboard user definition**: First-time downloads on Android devices
* **Source**: Google Play Console app statistics
* **Technical definition**
  * New users:["Users who have never installed your app before."](https://support.google.com/googleplay/android-developer/answer/139628?ref_topic=7071935&_ga=2.102707462.689223138.1687435526-1543025141.1678458294#zippy=%2Cinstall-related-statistics)
    * Users are counted per unique Google Play user account used to download.
  * Calculated per day based on Pacific Time (PT)
* **Known caveats**:
  * So long as a user is downloading from the same Google Play user account, they will not be double counted as a new user. It is possible that the same person may use more than one Google Play account to download over time.

---

## Appendix 1

### Google Play Store definitions for counting new downloads

Currently, we get our count of downloads for Android devices from the Google Play Store under the term ***Daily User Installs*** which is provided in a predefined Download statistics report. The [Google Play Console Help documentation](https://support.google.com/googleplay/android-developer/answer/6135870) that this report directs us to does not provide a definition of what the term means.**I could not find an official definition in my review of the wider documentation.**

One unofficial definition I did find was in a [discussion](https://support.google.com/googleplay/android-developer/thread/208932735/meaning-of-data-fields-given-by-google-play-store-for-app-download-install-statistics?hl=en#:~:text=Daily%20Device%20Installs%20%2D%20This%20represents,device%20in%20a%20single%20day.) on the Google Play Store community, a user stated they got the following definition via Chat GPT.

> This represents the number of new unique users who installed your app on their device in a single day.

I compared the counts that we've been using from that definition to a different Google Play Store metric, ***New Users***, which is clearly defined in their documentation as:
> Users who have never installed your app before.

The totals matched 91% of days between July 1, 2021, and May 31, 2023.

* The total difference between the definitions was 0.2%.
* The largest single day difference between definitions was 8.1%.

Given that we have alternative, well-defined metric options from Google Play Store that are very similar in totals, we do not need to rely on Daily User Installs moving forward.

## Appendix 2

### Calculations for rates of user behavior/experience in app

In light of the above definitions, I recommend the following standards for our calculations about app behavior/experience:

* Percent of users successfully logging in
  * Numerator: Total distict **Users**
  * Denominator: Total distinct **Personalized user**
* Percent of users doing X in app
  * Numerator: varied according to X
  * Denominator: total distinct number of **Personalized Users**

## Appendix 3

### Session definition

Sessions can be looked at in order per user (1st, 2nd,...500th session) so users and events can be grouped by the session number in which they occurred.

* **Dashboard user definition**: A span of interaction by the user with the app. It expires after 30 minutes of inactivity, and a new session will start the next time the user views the app. 
* **Source**: Google Analytics applied to Firebase app data
* **Technical definition**
  * > A session initiates when a user either opens your app in the foreground or views a page or screen and no session is currently active (e.g. their previous session has timed out). By default, a session ends (times out) after 30 minutes of user inactivity. There is no limit to how long a session can last.
  * Source: [GA4 About analytics sessions documentation](https://support.google.com/analytics/answer/9191807)
* **Known caveats**:
  * The timeout window can be adjusted but the app currently uses the defaults.
  * This definition likely does not align to how users would describe a descrete unit of interaction with the app.
