#  MVP Status and decisions for form detail landing pages

## 08/24/20

Summarizing ETA calendar per Mickin's Slack message: https://dsva.slack.com/archives/CUB5X5MGF/p1597853280234800

**Week of 8/24**

- complete accessibility checks + analytics implementation - Nick
- complete QA (early next week) - Tze
- remediate any QA/Accessibility findings - Nick
- staging (UAT) review (asynch?) - Mickin/Jen

**Next week (8/27)**

- coordinate with relevant stakeholders - Jen
- start the roll-out process for batches per [release plan](https://github.com/department-of-veterans-affairs/va.gov-team/blob/master/products/find-va-forms-redesign/form-detail-landing-pages/release-plan.md) - Mickin/Jen



## 07/31/20

__Summary:__

- The bad [form reversion situation](https://dsva.slack.com/archives/CUB5X5MGF/p1596123199101700) has been resolved and is now showing in search. Thank you @Steve Wirt!

__Larger issues unsurfaced:__

- Currently, the API is using form number as the unique form identifier.

- The form number (LH calls these "form name") is not a unique identifier for forms.

- The rowID in the VA forms DB is the only unique form identifier.

- Currently the LH API does not use the deleted form flag. In order for PW team to provide users with a unique error message for deleted forms, the API would need to use the deleted flag. @nick  @Michael Bastos (Oddball) will sync on this [per this slack](https://dsva.slack.com/archives/CUB5X5MGF/p1595607905068300?thread_ts=1595601672.067800&cid=CUB5X5MGF).

- API does not suppress invalid PDFs. Charly thinks this must be logic that's only in the FE code that we can remove now?  (Separately, I asked Charly if LH can add to LH backlog: creating an autonotification of invalid and deleted forms to the VA forms managers, [per this Slack](https://dsva.slack.com/archives/CUB5X5MGF/p1596125866103900?thread_ts=1596123199.101700&cid=CUB5X5MGF) bc we are not on Jira.)

__Outcomes from 7/31:__

- @Steve Wirt will add rowID to the CMS migration, so LH can use this data -- this is is the only unique identifier of forms.

- LH @Charley @Michael Bastos (Oddball): will need a discovery re using the rowID in the API - ex: to use for debugging.

- LH should not use the GraphQL language code as a way to uniquely identify forms bc this is currently not used on any nodes and not for forms. There is no langage code in the source VA forms db.

- Steve will add a new CMS custom content field in the form detail page AX for form language (Spanish and Tagalog for now). @Steve Wirt and @Jen Lee to sync offline about how we might use this to solve some of the duplicate form number problems we've seen wrt Eng and Esp versions of forms.


## 07/15/20

### Summary status/decisions from biweekly forms call with Mikki, Andrew, Nick, Mickin, Steve, Jen:

__Form detail page URL situation__

- The URL is autogenerated by pulling from the Drupal "Form number" field. This Drupal field corresponds to the VA forms database field called "DisplayName." 
- Concern: that the URL will change without notice if/when something happens in the source VA forms DB that changes the form display name. 
- Solution: We can hard set the URL upon publishing the page by unchecking the autogenerate URL checkbox in the CMS. 
- For MVP: We will do this manually during batch publishing. 
- Action item: Jen will create a ticket for CMS team to create auto-uncheck logic upon a content editor setting the page to "Publish" state. This will further ensure removing multiple manual steps required for making sure this behavior is always in place. Due to limited CMS resources, this will be lower priority than LC and vet center facilities Q3 priorities. 

__Lighthouse API update__

- The cutover from web scrape is progressing.
- Andrew will confirm with Michael Bastos that the cutover should focus on just replacing the web scrape with forms data (and not conflate search data improvements for this task). 
- We want to have some objective measure of parity and that the cutover isn't 'breaking' the current state of search. We will use the criteria in [ticket #1156](https://app.zenhub.com/workspaces/vft-59c95ae5fda7577a9b3184f8/issues/department-of-veterans-affairs/va.gov-team/11156) to validate. 

## 07/08/20 

Closing the loop on [6/23 item re: Default "Draft" state of form detail page](https://github.com/department-of-veterans-affairs/va.gov-team/blob/master/products/find-va-forms-redesign/form-detail-landing-pages/status-and-decisions.md#062320)

**We will keep newly added and migrated forms as "draft" form detail pages in the CMS.** 

This won't affect the PDF form from appearing in the forms search itself. Per this [Slack thread](https://dsva.slack.com/archives/CUB5X5MGF/p1594215565383900), when forms are added or removed, we want the CMS to create an auto-notification to the PW team. Notifications is currently dependend on global CMS notifications work. Form notification is a requirement for the forms product. 


## 07/01/20

__Decisions/status from biweekly sync with Steve Wirt (CMS), Andrew Fichter (Lighthouse), Nick Sullivan (PW), Mickin Sahni (PM of PMs), and Jen Lee (PO)__

Decision: 
We will complete forms search before form detail pages. This is mainly dependent on Lighthouse API work (replacing web scrape with data call to Drupal). 

__Next phase of work - in order:__

1/ PW: Enable CMS preview functionality - this is needed for content team to validate their work.

2/ Lighthouse: Lighthouse API pulling from Drupal data - Andrew believes they can start this work this sprint, but will confirm with Lighthouse team and let us know EOD 7/2.

3/ PW: FE static page approach for form detail pages, per [ticket 10819](https://app.zenhub.com/workspaces/vft-59c95ae5fda7577a9b3184f8/issues/department-of-veterans-affairs/va.gov-team/10819). 



## 06/25/20

__Decision: FE approach__

Per decision in [ticket 10414](https://github.com/department-of-veterans-affairs/va.gov-team/issues/10414#issuecomment-649746714), we will use the standard CMS static approach for the form detail frontend. 



## 06/23/20

**Form detail landing page CMS AX validation**

A few minor updates needed before AX validation can be marked complete. 

1/ Form administration dropdown choices: Add "Veterans Affairs"; remove "DEPO"

2/ Add ability to add an in-body alert component (unique or reusable). This component should be allowed above the When to use this form custom field and PDF link.

3/ Meta title tag logic: "Va" should be "VA"

4/ Meta description field logic: Point to pull from the When to use this form field, when available. If none, should show empty. Is also over ridable with manual entry.

[See ticket 5653 for reference](https://app.zenhub.com/workspaces/vft-59c95ae5fda7577a9b3184f8/issues/department-of-veterans-affairs/va.gov-team/5653#issuecomment-648333556)


**Documenting some additional AX capabilities that Steve built into the forms AX:**

**Temporary emergency admin fix of db data**

If a form was added to the source VA forms db with errors (e.g., typo in the form title, etc.) - CMS admin (Kevin Walsh/Steve Wirt) can temporarily edit the source db data. This doesn't change the data in the source VA forms db, but does provide a temporary emergency fix for the published form page. This is only good for the day however -- the next nightly forms db migration will wipe out the temporary CMS fix. 

**Default "Draft" state of form detail page**

- Today the CMS nightly migration will bring in forms db data and generate a basic form detail page in the "Draft" state. A PW content editor will need to manually change the newly added page to "Publish" (and customize any fields if applicable). 
- To consider: This isn't the default behavior that Beth and I discussed (default: publish state) but should reconsider due to unreliable state of forms governance upstream inside the source forms db. 
- Either way, this won't affect the form from appearing in the forms search. Regardless of whether a form has a form detail page published, once the form data has been migrated into Drupal, it will appear in the forms search. 


## 06/18/20

Historical - referencing for ease of findability. 

Form detail landing page IA/URL approach - documented here: 

https://github.com/department-of-veterans-affairs/va.gov-team/blob/master/platform/information-architecture/ia-reviews/websites-forms-detail-pages.md



## 05/12/20

Status of ETA per call with Beth Jacobson, Andrew Fichter, Jen Lee, and Stephanie Orkand. Beth shared her diagram WIP for final state of API flows. 

__Current target ETA about 5 weeks to get us to Graph QL stage:__

- 1 week to complete content modeling
- 1 week to migrate VA forms DB
- 1 week to scrpt migrations for the custom content fields
- 1 week for CMS team and content team to check/QA migrations
- 1 week cushion for things that could go wrong

__Who's responsible for what parts:__
- Connecting to and migrating forms DB into Drupal: Beth
- Exposing the Graph QL: Beth
- Grabbing the Graph QL to bring into the Lighthouse forms API: Lighthouse team (Andrew POC)

__RE using sample data to start migration work:__
- If we used sample data to start, we'd need to do it in staging; and then recreate it in prod. Question/initial thought: Might be better to just do it in prod (don't want to use fake data in prod). TBC. 

__Next step:__
- Biweekly (every 2 weeks) check-in with Lighthouse team for ongoing coordination. @stephanie



## 05/07/20

__Decision re non-VA forms and form detail landing page:__

__We will not disable non-VA forms from being published as form detail landing pages.__ There are not that many of them, and for those that do have search value, it's an opportunity to make people aware of VA benefits and services, and as a government agency, we are still better equipped to send people to the source of truth (vs. non-government sites that hijack government forms for nefarious purposes). 



## 05/06/20
Outcome - form detail landing page migration process and requirements - call with Beth Jacobson. 

(Updated 5/7)

__Changes in undestanding and requirements:__

- Nightly migration will automatically generate a form detail landing page in the CMS in publish state. 

- When a new form is added or a form is removed, a PW content editor will review the form detail page and add customized field data if needed or delete the form detail page and initiat a redirect. 

- Only someone with PW content publisher permission can edit, delete, and publish form detail landing pages. 

- If the form is mot a VA form, the PW content editor/publisher will check that value. This will not (in MVP 1.0) exclude it from search. It will show on the form detail Related to field some TBD verbiage that this is not a VA form and possibly provide a link to the GSA forms site.  

- @beth will create a batch publishing dashboard for migrated forms. This will allow the PW content team and QA to validate the initial set of forms in Draft state, and publish them together as a batch after validation/QA. 

- We need a notification mechanism in order to know when a new form has been added or deleted (vis-a-vis removing/redirecting the associated form detail landing page). @beth to look into this [notification ticket #8567](https://app.zenhub.com/workspace/o/department-of-veterans-affairs/va.gov-team/issues/8567)  TBD if this needs FE and/or Lighthouse support as well. 



__Use case of deleted forms that we need to work out__ 

When forms are deleted from the source VA Forms DB, we have to address a couple things: 

1/ If the form had a high value form detail landing page, how will we retire the page and redirect it? 

2/ If the form had a low/no value form detail landing page, how will we retire the page and will we redirect it? 

In order to do either of the above, PW content team needs to get notified when a form has been deleted in the forms DB. 

__Next steps:__ 

- Discovery for event notification ticket @beth

- Jen find out with stakeholders how often forms are added/removed, what their current process is for retiring and redirecting. 



## 04/29/20

Outcome from call w/Beth Jacobson re migration approach for custom fields that don't come from the forms database: __Related to__; __Online tool__; __When to use this form__. 


__Migration:__

1/ Beth will do a discovery to see how this might work. 

2/ The form PDF URL can stand in as the 'key' that connects the migrated data to a form record. 

3/ Related to, Online tool, and When to use this form values can all be included as part of the migration. 

4/ As a CSV spreadsheet. 

5/ Each related to value as a column, with an X if a form gets that value. 

6/ No problem that she can see at this time to do a staggered migration. I.e., first chunk for the top 30-40 mvp high value forms; 2nd chunk for all the other forms. (This gives us time for VA stakeholders to add those values into a shared spreadsheet for the other 500ish forms in the database.)


__Other outcomes:__

- We will create a Related to value for forms that are not VA forms -- Not a VA form/Non-VA form -- so that in the future, we have the option to use this tag to suppress/hide non-VA forms from search or from getting a VA form detail landing page. (Rationale: We don't want VA form detail landing pages to compete with the source of truth - e.g., OPM and GSA forms that actually have form pages on the OPM/GSA forms site.)

- We will not add a "Veterans" label (like we have for Family member benefits and Service member benefits). Rationale: all benefits on VA are essentially Veteran related, even the ones that are family member or service member benefits.

__Next steps:__
- Beth will create a discover ticket for migration approach. 

- Jen will update CSV format per fields needed for migration, with solidified Related to values. 

- Jen will coordinate stakeholders filling out the 500ish form values. 


## 04/27/20

Outcomes from call w/Beth Jacobson re Drupal form detail landing page data fields schema. 

#### Drupal field label nomenclature mapping: 

We decided on the general approach to map the CMS AX labels to the frontend form detail landing page user interface label as closelyl as possible. 


#### "Revision date" field label value: 

- We will change this label to __"Form last updated"__

- This change affects FE design - the label that appears on the search results and on the form detail landing page. (Don't change search results design yet until properly socialized with forms managers.)

- The date displayed will be the revision date from the forms database; if there's no revision date value, we will display the date from the issue date field. 

#### "Related to" field logic:  

- By default, when a new form is added in the database, the __Related to__ field will display the associated form owner from the forms database: VA, VHA, VBA, or NCA

- The default value can be overridden in Drupal by the content editor to display one or more of the related to values (e.g., Health care, Education and training, Family members, etc.) 

- The complete list of related to values still needs to be solidified. 


#### Next step:

Jen solidifies Related to values. 


## 04/24/20

Call w/ Stephanie, Nick, Mikki, Andrew Fichter, Jen Lee, Beth Jacobson, and John Hashimoto. 

__Confirmed:__ PW can use Lighthouse forms api credstash to connect Drupal to VA forms db. Nick will get that from Andrew's team. 

__Confirmed:__ After Drupal connects to the VA forms db, and new data fields (online tool, related to, related forms...) are available in the CMS, Lighthouse can begin pulling all forms data via Drupal graph ql for both search and form detail landing pages. 
Beth showed iteration so far of Drupal content model of data fields and how each one maps to the form detail page UI. 

__Decision:__ RE Drupal data field labels. We agreed and decided to map the Drupal field labels to the FE form detail page UI label. This reduces potential confusion and eliminates having to comprehend 3 variations of labels (VA forms DB field label, Drupal label, front end UI label). 

__Next steps:__
Beth and Jen need more working sessions to work out CMS field labels and mapping. 

We need another sync to go over IA and URL generation with Drupal.
