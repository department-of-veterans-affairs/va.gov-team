# MVP

For a MVP, we are going to keep things are simple as possible.

## Use Case

As a veteran, 
I need to know what questionnaires I need to fill out for my upcoming appointment,
so that I can give my healthcare provider better information. 

## Next Steps

- [X] Create notes
- [X] Create Diagram
- [ ] FHIR structure
- [X] Answer where can we store the association? 
- [ ] Verify Endpoints exist on MAP and PGD.
- [ ] Present to team
- [ ] Determine Next steps
- [ ] Tickets

## High Level

We plan on using VeText to aid in the notification of the vets of their appointment. They are already doing it and we want to leverage them.

For this, once we figure out the pilot sites, we have VeText update the template to include a static url. That URL will link the users to their questionnaire manager page. This static link will be the same for each veteran. It will be something like `va.gov/healthcare/questionnaire/mananger` (or something shorter with a URL shortener). This will make that notification easier since the url is not changing per user or per questionnaire.

Once a user gets to that page and logs in, we can then check if they have a questionnaire to fill out. We can do this because we have the user's ICN number. Using that ICN number we can get their upcoming appointments. We can then check those appointments against the [Questionnaire](https://www.hl7.org/fhir/questionnaire.html) and  [Questionnaire Responses](https://www.hl7.org/fhir/questionnaireresponse.html) we are storing in PGD. If the appointment (based on type, facility and clinic) has a Questionnaire and the user doesn't have Questionnaire Response, then we can mark that a questionnaire needed fill out. This will show up in the tabbed layout we can show the users and highlight upcoming questionnaires.

This solution is only a first step. Ideally, the notification that the veteran gets already knows, but that requires more developer work on other teams than we want to currently do or have sprints for.

## Diagram

![Sequence Diagram](assets/trigger.mvp.png)

[draw.io link](https://drive.google.com/file/d/1jM5Wc3-jWCfylWVqn8CbMshw_3T2yYs0/view)

## Notes

- The association is a unique combination of `Appointment Type`, `Clinic Id`, and `Facility Id`.
- This can stored in URI for the questionnaire following a pattern like `va:questionnaire/facility/{Facility ID}/clinic/{Clinic ID}/appointment/{appointment type}`. And example would be 
- `va:questionnaire/facility/123/clinic/456/appointment/follow-up`. 
 or 
 hash(fId, cId, appt) => `abc123`



## End points 



## Outstanding Questions

- Is there a specific use case that we need to know when an appointment is booked? Or is it more, we need to know if the user has an upcoming questionnaire? 
- How many facilities/clinics do we plan to roll this out to over time (MVP, beta, full rollout, etc)
- Are there a base set of questions that all appointments will need, or are all questions going to be specific to appointment type/facility/clinic?
- Do we have a URL shortern service with va.gov?
